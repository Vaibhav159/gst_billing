{% extends 'base.html' %}


{% block content %}
<style>
    table.tb2 tr:first-of-type {
        border-bottom: 2px solid black;
    }

    table.tb2 tr:last-of-type {
        border-top: 2px solid black;
    }
    .bordered_td {
        border-right: solid 1px #000;
        border-left: solid 1px #000;
        text-align: center;
    }

    #bordered-left-aligned-td {
        text-align: left;
        padding-left: 50px;
        border-right: solid 1px #000;
        border-left: solid 1px #000;
    }

    th {
        text-align: center;
    }

    @media print {
        @page {
            margin: 15mm;
        }
        body {
            visibility: hidden;
        }
        #panel, #panel * {
            visibility: visible;
        }
        #panel {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
        }
        .no-print {
            display: none;
        }
    }
</style>

<div class="flex items-center gap-3 p-4 no-print">
    <a href="{% url 'invoice_detail' invoice.id %}"
       class="inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
        </svg>
        Back to Invoice {{ invoice.id }}
    </a>

    <button type="button" 
            onclick="window.print();"
            class="inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-orange-500 rounded-md hover:bg-orange-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500">
        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"/>
        </svg>
        Print Invoice
    </button>
</div>

<div id="panel">
    <table style="border: 1px solid #999999; width: 100%; max-width: 210mm; margin: 0 auto;" cellpadding="0" cellspacing="0" class="tb">
        <tbody>
            <tr>
                <td height="35" colspan="4" align="center" class="txt"
                    style="border-bottom: 1px solid #ddd; color: {{ invoice.business.primary_color_theme }}; font-weight: 800;
                    font-family: 'Muli', sans-serif; font-size: 20px;">
                    TAX INVOICE
                </td>
            </tr>
            <tr>
                <td style="width: 3%;">&nbsp;</td>
                <td style="width: 47%;">
                    {% include "invoicing/business_selection.html" with business=invoice.business %}
                </td>
                <td style="width: 47%;">
                    {% include "invoicing/business_bank_details.html" %}
                </td>
                <td style="width: 3%;">&nbsp;</td>
            </tr>
            <tr>
                <td colspan="4" style="height: 20px;">&nbsp;</td>
            </tr>
            <tr>
                <td style="width: 3%;">&nbsp;</td>
                <td colspan="2">
                    <table width="100%" border="0" cellpadding="0" cellspacing="0">
                        <tbody>
                            {% include "invoicing/customer_selection.html" with customer=invoice.customer invoice_number=invoice.invoice_number invoice_date=invoice.invoice_date %}
                            {% include 'invoicing/line_item_selection.html' %}

                            <tr>
                                <td style="height: 20px;">&nbsp;</td>
                            </tr>
                            <tr>
                                <td>
                                    {% include "invoicing/invoice_final_summary.html" %}
                                </td>
                            </tr>

                            <tr>
                                <td style="height: 20px;">&nbsp;</td>
                            </tr>
                        </tbody>
                    </table>
                </td>
                <td style="width: 3%;">&nbsp;</td>
            </tr>
            <tr>
                <td colspan="4" style="height: 40px;">&nbsp;</td>
            </tr>
            <tr>
                <td colspan="4" style="font-size: 13px; color: #000; padding: 5px; font-family: 'Muli', sans-serif;">
                    <div style="display: flex; justify-content: space-between; padding: 0 50px;">
                        <div style="text-align: center;">
                            <div style="border-top: 1px solid #000; padding-top: 5px;">
                                <strong>Customer Signature</strong>
                            </div>
                        </div>
                        <div style="text-align: center;">
                            <div style="border-top: 1px solid #000; padding-top: 5px;">
                                <strong>Authorized Signature</strong>
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
            <tr>
                <td colspan="4" style="height: 20px;">&nbsp;</td>
            </tr>
        </tbody>
    </table>

    <div style="text-align: center; margin-top: 20px;">
        <p style="font-size: 20px; color: #000; padding: 5px; font-family: 'Muli', sans-serif;">
            <strong>SUBJECT TO UDAIPUR JURISDICTION</strong>
        </p>
    </div>

</div>

    {% block javascripts %}
        <script>
            document.title = "{{ invoice.invoice_number }}-{{ invoice.business.name }}-{{ invoice.invoice_date.year }}";
        </script>
    {% endblock %}
{% endblock %}
